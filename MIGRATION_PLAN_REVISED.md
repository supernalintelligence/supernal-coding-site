# Docusaurus to Next.js - Proper Migration Plan

**Problem**: Current Next.js site doesn't match Docusaurus functionality
**Root Cause**: Built from scratch instead of migrating Docusaurus structure
**Solution**: Properly migrate Docusaurus content and structure

---

## Current Docusaurus Structure (Working)

### Docs Path

```
documentation/docs/ ‚Üí ../docs/  (symlink)
```

**Points to**: `/Users/.../supernal-coding/docs/`

### Content Locations:

1. **Blog**: `documentation/blog/*.md` (15 posts)
2. **Docs**: `../docs/` ‚Üí Multiple sections:
   - `guides/` - Getting started, CLI commands, visual guides
   - `workflow/sops/` - Standard Operating Procedures (61 files)
   - `requirements/compliance/` - Compliance frameworks
   - `architecture/` - System architecture
   - And many more...

### Sidebar Structure (from sidebars.ts):

```
üöÄ Getting Started
  - What is Supernal Coding
  - Overview

üìã Standard Operating Procedures
  - SOP-0 Overview
  - SOP-0.1 AI Workflow
  - AI Workflow Foundations (collapsed)
  - Phase-Specific SOPs (collapsed)
    - Phase 1-12 (each with autogenerated files)
  - Tool-Specific SOPs (collapsed)

üìö Guides
  - Quick Reference (CLI commands, phases)
  - Visual Guides (dashboard, workflow diagrams)
  - Additional Guides (config, git hooks)

üèõÔ∏è Compliance Frameworks (collapsed)
  - FDA 21 CFR 11
  - ISO 13485
  - HIPAA
  - GDPR
  - ISO 27001
  - And more...
```

---

## What's Wrong with Current Next.js Site

### 1. Content Location

- ‚ùå Blog posts are in `apps/docs-next/docs/blog/` (isolated)
- ‚úÖ Should point to `documentation/blog/` (source of truth)

### 2. Docs Structure

- ‚ùå Only has stub index files
- ‚úÖ Should point to `../../docs/` (all the real docs)

### 3. Sidebar

- ‚ùå Hardcoded config sections that don't match content
- ‚úÖ Should autogenerate from actual folder structure like Docusaurus

### 4. Logo/Branding

- ‚ùå Uses Ian Derrington name/logo
- ‚úÖ Should use Supernal Coding with `/logo.svg`

### 5. Blog Slugs

- ‚ùå Double prefix: `/blog/blog/...`
- ‚úÖ Should be just `/blog/{slug}` (no date)

---

## Proper Migration Strategy

### Phase 1: Content Symlinks (Immediate)

```bash
# Point to actual content
cd apps/docs-next/docs
rm -rf blog guides  # Remove stubs
ln -s ../../../documentation/blog blog
ln -s ../../docs content  # Real docs
```

### Phase 2: Sidebar Generation (Critical)

Instead of hardcoded config, **autogenerate sidebar from folder structure** like Docusaurus:

```typescript
// lib/content/sidebar.ts
export function generateSidebar(docsPath: string) {
  // 1. Read directory structure
  // 2. Parse frontmatter for order/title
  // 3. Build hierarchical tree
  // 4. Match Docusaurus sidebar.ts structure
}
```

### Phase 3: Route Structure (Match Docusaurus)

```
Docusaurus:
  /docs/guides/getting-started/intro
  /blog/2025-01-19-principles-driven-development

Next.js:
  /docs/guides/getting-started/intro  ‚úì (same)
  /blog/principles-driven-development  ‚úì (use frontmatter slug)
```

### Phase 4: Components (Port from Docusaurus)

- Keep using Docusaurus components we already copied
- HomepageFeatures, WorkflowDiagram, CompetitiveComparison, InteractiveWorkflow
- These already work!

---

## Key Docusaurus Features to Preserve

### 1. Autogeneration

```typescript
{
  type: 'autogenerated',
  dirName: 'workflow/sops/general'
}
```

**Next.js equivalent**: Read directory, parse frontmatter, build tree

### 2. Collapsible Categories

```typescript
{
  type: 'category',
  label: 'Phase-Specific SOPs',
  collapsed: true,
  items: [...]
}
```

**Next.js equivalent**: `CollapsibleSection` component

### 3. Sidebar Ordering

**Docusaurus**: Uses file order or frontmatter `sidebar_position`
**Next.js**: Use frontmatter `order` field (already implemented)

### 4. Blog Date Slugs

**Docusaurus**: File name `2025-01-19-title.md` ‚Üí slug from frontmatter or filename
**Next.js**: Always use frontmatter `slug` field (ignore date in filename)

---

## Implementation Plan

### Step 1: Fix Content Paths (30 min)

```bash
# Point to real content instead of stubs
cd apps/docs-next/docs
rm -rf blog  # Remove stub blog
ln -s ../../../documentation/blog blog  # Real blog

# Or copy if symlinks don't work on Vercel
cp -r ../../../documentation/blog/* blog/
```

### Step 2: Create Sidebar Generator (2 hours)

```typescript
// lib/content/docsSidebar.ts
export async function generateDocsSidebar() {
  // Read ../../docs/ structure
  // Parse frontmatter for titles/order
  // Build hierarchical structure matching sidebars.ts
  // Support collapsed/expanded state
}
```

### Step 3: Create DocsSidebar Component (1 hour)

```tsx
// components/docs/DocsSidebar.tsx
<aside className="col-span-3">
  {sections.map(section => (
    <CollapsibleSection
      title={section.label}
      collapsed={section.collapsed}
      items={section.items}
    />
  ))}
</aside>
```

### Step 4: Fix Blog Routing (30 min)

- Ensure slug uses frontmatter `slug` field only
- Strip "blog/" prefix when constructing links
- Remove date from URL

### Step 5: Update Docs Route (1 hour)

```tsx
// app/docs/[...slug]/page.tsx
- Use generateDocsSidebar()
- 3-column layout: Sidebar | Content | TOC
- Match Docusaurus look and feel
```

---

## Quick Wins (Do First)

1. ‚úÖ Fix logo (Ian ‚Üí Supernal) - DONE
2. ‚úÖ Fix blog slugs (remove double prefix) - DONE
3. ‚úÖ Add more SVG colors - DONE
4. ‚è≥ Copy logo.svg from documentation/static/img/
5. ‚è≥ Point blog to real content (`documentation/blog/`)
6. ‚è≥ Point docs to real content (`../../docs/`)
7. ‚è≥ Create sidebar generator from folder structure

---

## Decision Points

### Content Strategy:

**Option A**: Symlinks (fast, single source of truth)

- ‚úÖ Pro: Instant access to all content
- ‚ùå Con: May not work on Vercel

**Option B**: Copy content (safe, works everywhere)

- ‚úÖ Pro: Guaranteed to work
- ‚ùå Con: Need sync strategy

**Option C**: Direct path import (best)

- ‚úÖ Pro: No copying, no symlinks
- ‚úÖ Pro: Just change content paths in lib/content
- ‚úÖ Recommended!

### Sidebar Strategy:

**Option A**: Autogenerate from filesystem (like Docusaurus)

- ‚úÖ Pro: Automatic, no maintenance
- ‚ùå Con: Complex to implement

**Option B**: Use existing sidebars.ts structure

- ‚úÖ Pro: Already defined
- ‚úÖ Pro: Can convert to JSON config
- ‚úÖ Recommended!

---

## Recommended Approach

### 1. Immediate Fixes (30 min)

- ‚úÖ Logo/branding - DONE
- ‚úÖ Slug fixes - DONE
- Copy `logo.svg` to `apps/docs-next/public/`
- Update content paths in `lib/content/` to point to `../../docs/`

### 2. Sidebar Migration (2 hours)

- Convert `sidebars.ts` structure to JSON
- Create sidebar generator that reads this structure
- Implement `DocsSidebar` component with collapsible sections

### 3. Route Migration (1 hour)

- Ensure `/docs/[...slug]` reads from `../../docs/`
- Ensure `/blog/[slug]` reads from `../../documentation/blog/`
- Match Docusaurus routing exactly

---

## Critical Question for User

**Should I**:

1. **Quick fix**: Change content paths to point to existing `documentation/` and `docs/` directories?
2. **Full migration**: Properly implement sidebar autogeneration matching Docusaurus exactly?
3. **Hybrid**: Quick fix content paths now, improve sidebar later?

**My recommendation**: #1 (Quick fix) to get it working, then #2 (Full migration) in next session.

---

**Next Steps**: Waiting for your decision on approach before proceeding.
